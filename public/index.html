<!DOCTYPE html>

<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Firebase Hosting</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-analytics.js"></script>
    <script src='../routes/home/firebase.js'></script>
  </head>
  <body>

    
    <script>
      // Your web app's Firebase configuration
      var firebaseConfig = {
        apiKey: "AIzaSyA5I8jNkgH19JGRXPVz523OCAQHGjAxSYw",
        authDomain: "graduation-f5a8d.firebaseapp.com",
        databaseURL: "https://graduation-f5a8d.firebaseio.com",
        projectId: "graduation-f5a8d",
        storageBucket: "graduation-f5a8d.appspot.com",
        messagingSenderId: "767170513426",
        appId: "1:767170513426:web:3926482e507c84c72d26cb",
        measurementId: "G-J08EVYWLEL"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
      
    </script>
    <script>
    var provider= new firebase.auth.GoogleAuthProvider();

firebase.auth().signInWithPopup(provider).then(function(result){
  console.log(result.credential)
    var token=result.credential.accessToken;
    var user=result.user;
    console.log(user)
    console.log("token:"+token)
}).catch(function(error){
    var errorCode=error.code;
    var errorMessage=error.meessage;
    var email=error.email;
    var credential =error.credential;
})
firebase.auth().onAuthStateChanged(function(user){
  if(user){

    var uid=user.uid;
    console.log("uid:"+uid)

    user.getIdToken()
    .then(token=>{
      $.ajax({
        url:'/user_info/join',
        method:'POST',
        data:{'toekn':token, 'email': 'gyrlf2478@maver.com', name:'dfasfasfsaf'},
        success:function(data){
          console.log(data)
        },
        error:function(xhr,statue,error){
          console.log('error!!')
          console.log(xhr)
          console.log(statue)
        }
      })
      console.log(token)
    })
  }else{

  }
})



    </script>
  </body>

</html>
